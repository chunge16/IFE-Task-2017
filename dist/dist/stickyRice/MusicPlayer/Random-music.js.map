{"version":3,"sources":["../../../stickyRice/MusicPlayer/Random-music.js"],"names":["window","onload","init","audios","document","getElementById","app","Vue","el","data","loop","imgSrc","channelId","song","seen","picture","url","songName","artist","volume","paused","animationPlayState","isPlaying","created","getChannel","getMusic","volumeChange","setInterval","progress","methods","play","pause","nextSong","axios","get","then","response","console","log","channels","num","Math","floor","random","length","channel_id","bind","catch","error","channel","params","title","src","songLoop","currentTime","duration","plan","querySelector","btn","style","width","left","btnDown","event","clientX","barChange","clientWidth","targetWidth","offsetX","scale"],"mappings":"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","file":"Random-music.js","sourcesContent":["'use strict';\n\n/**\n * Created by shi on 2017/5/3.\n */\n\nwindow.onload = function () {\n\n    function init() {\n\n        var audios = document.getElementById('audios');\n\n        var app = new Vue({\n            el: '#fm',\n            data: {\n                loop: {\n                    imgSrc: 'imgs/icon_order.png'\n                },\n                channelId: 0,\n                song: {\n                    seen: false,\n                    picture: '',\n                    url: '',\n                    songName: '',\n                    artist: '',\n                    volume: 0.5\n                },\n                paused: {\n                    animationPlayState: \"running\"\n                },\n                isPlaying: false\n            },\n            created: function created() {\n                this.getChannel();\n                this.getMusic(this.channelId);\n                this.volumeChange(null, true);\n                setInterval(this.progress, 500);\n            },\n            methods: {\n                //播放和暂停\n                play: function play() {\n                    if (audios.paused) {\n                        this.song.seen = false;\n                        this.paused = {\n                            animationPlayState: \"running\"\n                        };\n                        if (!this.isPlaying) {\n                            audios.play();\n                            this.isPlaying = true;\n                        }\n                    } else {\n                        this.song.seen = true;\n                        this.paused = {\n                            animationPlayState: \"paused\"\n                        };\n                        if (this.isPlaying) {\n                            audios.pause();\n                            this.isPlaying = false;\n                        }\n                    }\n                },\n                //随机下一首\n                nextSong: function nextSong() {\n\n                    if (this.song.seen) {\n                        this.song.seen = false;\n                        this.getMusic(this.channelId);\n                    } else {\n                        this.getMusic(this.channelId);\n                    }\n                },\n                getChannel: function getChannel() {\n                    axios.get('http://api.jirengu.com/fm/getChannels.php').then(function (response) {\n                        console.log(response.data);\n                        var channels = response.data.channels;\n                        var num = Math.floor(Math.random() * channels.length);\n\n                        this.channelId = channels[num].channel_id;\n                        console.log(this.channelId);\n                    }.bind(this)).catch(function (error) {\n                        console.log(error);\n                    });\n                },\n                getMusic: function getMusic(channel) {\n                    axios.get('http://api.jirengu.com/fm/getSong.php', {\n                        params: {\n                            \"channel\": channel\n                        }\n                    }).then(function (response) {\n                        console.log(response.data);\n                        var song = response.data.song[0];\n                        this.song = {\n                            seen: false,\n                            picture: song.picture,\n                            url: song.url,\n                            songName: song.title,\n                            artist: song.artist\n                        };\n                        audios.src = song.url;\n                        audios.play();\n                        this.isPlaying = true;\n                    }.bind(this)).catch(function (error) {\n                        console.log(error);\n                    });\n                },\n                //是否单曲循环\n                songLoop: function songLoop() {\n                    if (audios.loop) {\n                        this.loop = {\n                            imgSrc: 'imgs/icon_order.png'\n                        };\n                        audios.loop = false;\n                    } else {\n                        this.loop = {\n                            imgSrc: 'imgs/icon_loop.png'\n                        };\n                        audios.loop = true;\n                    }\n                    console.log(audios.loop);\n                },\n                progress: function progress() {\n                    var length = audios.currentTime / audios.duration * 100,\n                        plan = document.querySelector('.fm-controls_plan'),\n                        btn = document.querySelector('.fm-controls_btn');\n\n                    plan.style.width = length + '%';\n                    btn.style.left = length + '%';\n\n                    //自动下一曲\n                    if (audios.currentTime === audios.duration) {\n                        app.nextSong();\n                    }\n                },\n                //拖动快进\n                btnDown: function btnDown(event) {\n                    console.log(event.clientX);\n                },\n                //点击快进\n                barChange: function barChange(event) {\n                    //总长度\n                    var length = document.querySelector('.fm-controls_center').clientWidth,\n\n                    //点击位置\n                    targetWidth = event.offsetX;\n                    //比例\n                    var scale = targetWidth / length;\n\n                    //设置音频位置\n                    audios.currentTime = audios.duration * scale;\n\n                    //暂停后重新快进播放\n                    if (audios.paused) {\n                        this.song.seen = false;\n                        this.paused = {\n                            animationPlayState: \"running\"\n                        };\n                        if (!this.isPlaying) {\n                            audios.play();\n                            this.isPlaying = true;\n                        }\n                    }\n                },\n                //调节音量\n                volumeChange: function volumeChange(event, num) {\n                    var length = document.querySelector('.fm-volume').clientWidth - 35,\n                        targetWidth = null,\n                        scale = 0,\n                        plan = document.querySelector('.fm-volume_plan');\n\n                    if (num) {\n                        audios.volume = this.song.volume;\n                        plan.style.width = length * 0.5 + 'px';\n                    } else {\n                        targetWidth = event.offsetX;\n                        scale = targetWidth / length;\n\n                        this.song.volume = scale;\n                        audios.volume = scale;\n                        console.log(scale);\n                        plan.style.width = targetWidth + 'px';\n                    }\n                }\n\n            }\n        });\n    }\n\n    init();\n\n    //vue v-bind 无法修改  audio  的属性\n\n};\n//# sourceMappingURL=Random-music.js.map"]}