{"version":3,"sources":["../../../stickyRice/node-base/test.js"],"names":["page","require","create","system","fs","key","args","url","encodeURI","time","Date","now","data","length","console","log","open","status","code","msg","word","JSON","stringify","write","phantom","exit","includeJs","evaluate","result","total","$","i","len","list","title","prev","text","info","find","link","attr","pic","push","dataList"],"mappings":";;AAAA,IAAIA,OAAOC,QAAQ,SAAR,EAAmBC,MAAnB,EAAX;AAAA,IACIC,SAASF,QAAQ,QAAR,CADb;AAAA,IAEIG,KAAKH,QAAQ,IAAR,CAFT;;AAIA,IAAII,MAAMF,OAAOG,IAAP,CAAY,CAAZ,CAAV;AAAA,IACIC,MAAM,gCAAgCC,UAAUH,GAAV,CAD1C;AAAA,IAEII,OAAOC,KAAKC,GAAL,EAFX;AAAA,IAGIC,OAAO,EAHX;;AAKA,IAAIT,OAAOG,IAAP,CAAYO,MAAZ,KAAuB,CAA3B,EAA8B;AAC1BC,YAAQC,GAAR,CAAY,UAAZ;AAEH,CAHD,MAGO;AACHf,SAAKgB,IAAL,CAAUT,GAAV,EAAe,UAASU,MAAT,EAAiB;AAC5B,YAAIA,WAAW,SAAf,EAA0B;AACtBR,mBAAOC,KAAKC,GAAL,KAAaF,IAApB;AACAG,mBAAO;AACHM,sBAAM,CADH,EACQ;AACXC,qBAAK,MAFF,EAEU;AACbC,sBAAMf,GAHH,EAGU;AACbI,sBAAMA,IAJH,EAAP;AAMAG,mBAAOS,KAAKC,SAAL,CAAeV,IAAf,EAAqB,IAArB,EAA2B,CAA3B,CAAP;AACAR,eAAGmB,KAAH,CAAS,WAAT,EAAsBX,IAAtB,EAA4B,GAA5B;AACAY,oBAAQC,IAAR;AACH,SAXD,MAWO;AACHhB,mBAAOC,KAAKC,GAAL,KAAaF,IAApB;AACAT,iBAAK0B,SAAL,CAAe,6CAAf,EAA8D,YAAW;;AAErEd,uBAAOZ,KAAK2B,QAAL,CAAc,UAASlB,IAAT,EAAeJ,GAAf,EAAoB;AACrC,wBAAIuB,SAAS,EAAb;AACA,wBAAIC,QAAQC,EAAE,wBAAF,CAAZ;AACA,yBAAK,IAAIC,IAAI,CAAR,EAAWC,MAAMH,MAAMhB,MAA5B,EAAoCkB,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;AAC9C,4BAAIE,OAAO,EAAX;AACAA,6BAAKC,KAAL,GAAaJ,EAAED,MAAME,CAAN,CAAF,EAAYI,IAAZ,GAAmBC,IAAnB,MAA6B,EAA1C,CAF8C,CAEC;AAC/CH,6BAAKI,IAAL,GAAYP,EAAED,MAAME,CAAN,CAAF,EAAYO,IAAZ,CAAiB,uBAAjB,EAA0CF,IAA1C,MAAoD,EAAhE,CAH8C,CAGuB;AACrEH,6BAAKM,IAAL,GAAYT,EAAED,MAAME,CAAN,CAAF,EAAYI,IAAZ,GAAmBG,IAAnB,CAAwB,GAAxB,EAA6BE,IAA7B,CAAkC,MAAlC,KAA6C,EAAzD,CAJ8C,CAIgB;AAC9D,4BAAIC,MAAMX,EAAED,MAAME,CAAN,CAAF,EAAYO,IAAZ,CAAiB,eAAjB,CAAV,CAL8C,CAKG;AACjDL,6BAAKQ,GAAL,GAAYA,OAAOA,IAAI5B,MAAZ,GAAsB4B,IAAID,IAAJ,CAAS,KAAT,CAAtB,GAAwC,EAAnD;AACAZ,+BAAOc,IAAP,CAAYT,IAAZ;AACH;;AAED,2BAAOZ,KAAKC,SAAL,CAAe;AAClBJ,8BAAM,CADY;AAElBC,6BAAK,MAFa;AAGlBC,8BAAMf,GAHY;AAIlBI,8BAAMA,IAJY;AAKlBkC,kCAAUf;AALQ,qBAAf,EAMJ,IANI,EAME,CANF,CAAP;AAQH,iBArBM,EAqBJnB,IArBI,EAqBEJ,GArBF,CAAP;AAsBAS,wBAAQC,GAAR,CAAYH,IAAZ;AACAR,mBAAGmB,KAAH,CAAS,WAAT,EAAsBX,IAAtB,EAA4B,GAA5B;AACA;;;;;;AAMAY,wBAAQC,IAAR;AACH,aAjCD;AAkCH;AAEJ,KAlDD;AAoDH;;AAGD","file":"test.js","sourcesContent":["var page = require('webpage').create(),\n    system = require('system'),\n    fs = require('fs');\n\nvar key = system.args[1],\n    url = \"https://www.baidu.com/s?wd=\" + encodeURI(key),\n    time = Date.now(),\n    data = {};\n\nif (system.args.length === 1) {\n    console.log('请输入搜索词  ');\n\n} else {\n    page.open(url, function(status) {\n        if (status !== \"success\") {\n            time = Date.now() - time;\n            data = {\n                code: 0,\t\t\t// 返回状态码，1为成功，0为失败\n                msg: '抓取失败',\t// 返回的信息\n                word: key,\t\t\t// 抓取的关键字\n                time: time,\t\t\t// 任务的时间\n            };\n            data = JSON.stringify(data, null, 4);\n            fs.write(\"task.json\", data, 'w');\n            phantom.exit();\n        } else {\n            time = Date.now() - time;\n            page.includeJs(\"https://code.jquery.com/jquery-3.1.1.min.js\", function() {\n\n                data = page.evaluate(function(time, key) {\n                    var result = [];\n                    var total = $('.c-row.c-gap-top-small');\n                    for (var i = 0, len = total.length; i < len; i++) {\n                        var list = {};\n                        list.title = $(total[i]).prev().text() || '';\t\t// 结果条目的标题\n                        list.info = $(total[i]).find('.c-span18.c-span-last').text() || '';\t\t// 摘要\n                        list.link = $(total[i]).prev().find('a').attr('href') || '';\t\t// 链接\n                        var pic = $(total[i]).find('.c-img.c-img6');\t\t\t\t\t//缩略图地址\n                        list.pic = (pic && pic.length) ? pic.attr('src') : '';\n                        result.push(list);\n                    }\n\n                    return JSON.stringify({\n                        code: 1,\n                        msg: '抓取成功',\n                        word: key,\n                        time: time,\n                        dataList: result\n                    }, null, 4);\n\n                }, time, key);\n                console.log(data);\n                fs.write(\"task.json\", data, 'w');\n                /*\n                 *  使用write方法写文件的过程：\n                 *  1.将需要书写的数据书写到一个内存缓冲区；\n                 *  2.待缓冲区写满后再将该缓冲区中的内容写入到文件中\n                 *  3.重复执行1.2,直到数据全部写入文件为止\n                 */\n                phantom.exit();\n            });\n        }\n\n    });\n\n}\n\n\n/****\n * 1. 元素集合转换为数组，无法编译进行\n * 2. 文件模块不明白\n * *****/"]}