{"version":3,"sources":["../../../stickyRice/node-base/test.js"],"names":["system","require","webPage","page","create","key","args","time","Date","now","length","console","log","phantom","exit","open","encodeURIComponent","status","obj","code","msg","word","dataList","title","info","link","pic","JSON","stringify","includeJs","evaluate","Array","form","$","forEach","val","index","item","previousElementSibling","innerText","lastElementChild","firstElementChild","href","src","push"],"mappings":"AAAA;AACA;;AACA,IAAIA,SAASC,QAAQ,QAAR,CAAb;;AACI;AACAC,UAAUD,QAAQ,SAAR,CAFd;AAAA,IAGIE,OAAOD,QAAQE,MAAR,EAHX;AAAA,IAIIC,MAAML,OAAOM,IAAP,CAAY,CAAZ,CAJV;AAAA,IAKIC,OAAOC,KAAKC,GAAL,EALX;;AAOA;AACA,IAAIT,OAAOM,IAAP,CAAYI,MAAZ,KAAuB,CAA3B,EAA8B;AAC1BC,YAAQC,GAAR,CAAY,kDAAZ;AACAC,YAAQC,IAAR;AACH,CAHD,MAGO;AACHX,SAAKY,IAAL,CAAU,gCAAgCC,mBAAmBX,GAAnB,CAAhC,GAA0D,gJAApE,EAAsN,UAAUY,MAAV,EAAkB;AACpO,YAAIC,MAAM;AACNC,kBAAM,CADA,EACG;AACTC,iBAAK,MAFC,EAEO;AACbC,kBAAM,OAHA,EAGS;AACfd,kBAAM,IAJA,EAIM;AACZe,sBAAU,CAAI;AACV;AACIC,uBAAO,IADX,EACkB;AACdC,sBAAM,EAFV,EAEc;AACVC,sBAAM,EAHV,EAGc;AACVC,qBAAK,EAJT,CAIY;AAJZ,aADM;AALJ,SAAV;;AAeA,YAAIT,WAAW,SAAf,EAA0B;AACtBV,mBAAOC,KAAKC,GAAL,KAAaF,IAApB;AACAW,kBAAM;AACFC,sBAAM,CADJ,EACO;AACTC,qBAAK,MAFH,EAEW;AACbC,sBAAMhB,GAHJ,EAGS;AACXE,sBAAMA,IAJJ,EAIU;AACZe,0BAAU;AALR,aAAN;AAOAX,oBAAQC,GAAR,CAAYe,KAAKC,SAAL,CAAeV,GAAf,CAAZ;AACAL,oBAAQC,IAAR;AACH,SAXD,MAWO;AACHP,mBAAOC,KAAKC,GAAL,KAAaF,IAApB;AACAI,oBAAQC,GAAR,CAAY,aAAaP,GAAzB;AACAM,oBAAQC,GAAR,CAAY,kBAAkBL,IAAlB,GAAyB,OAArC;;AAEA;AACAJ,iBAAK0B,SAAL,CAAe,oDAAf,EAAqE,YAAY;AAC7E;AACA1B,qBAAK2B,QAAL,CAAc,YAAY;;AAEtBC,0BAAMC,IAAN,CAAWC,EAAE,wBAAF,CAAX,EAAwCC,OAAxC,CAAgD,UAACC,GAAD,EAAKC,KAAL,EAAe;AAC3D,4BAAIC,OAAO,EAAX;AACAA,6BAAKd,KAAL,GAAaY,IAAIG,sBAAJ,CAA2BC,SAAxC;AACAF,6BAAKb,IAAL,GAAYW,IAAIK,gBAAJ,CAAqBD,SAAjC;AACAF,6BAAKZ,IAAL,GAAYU,IAAIG,sBAAJ,CAA2BG,iBAA3B,CAA6CC,IAAzD;AACAL,6BAAKX,GAAL,GAAUS,IAAIM,iBAAJ,CAAsBA,iBAAtB,CAAwCA,iBAAxC,CAA0DE,GAApE;AACAzB,4BAAII,QAAJ,CAAasB,IAAb,CAAkBP,IAAlB;AACH,qBAPD;AASH,iBAXD;AAYA1B,wBAAQC,GAAR,CAAYe,KAAKC,SAAL,CAAeV,GAAf,CAAZ;AACAL,wBAAQC,IAAR;AACH,aAhBD;AAiBH;AAEJ,KApDD;AAsDH","file":"test.js","sourcesContent":["\"use strict\";\n//system模块可以加载操作系统变量，system.args就是参数数组\nlet system = require('system'),\n    //webpage模块是PhantomJS的核心模块，用于网页操作\n    webPage = require('webpage'),\n    page = webPage.create(),\n    key = system.args[1],\n    time = Date.now();\n\n//命令行没有给出参数\nif (system.args.length === 1) {\n    console.log('Try to pass some args when invoking this script!');\n    phantom.exit();\n} else {\n    page.open('https://www.baidu.com/s?wd=' + encodeURIComponent(key) + '&rsv_spt=1&rsv_iqid=0xa6ce1e3700030359&issp=1&f=8&rsv_bp=0&rsv_idx=2&ie=utf-8&tn=baiduhome_pg&rsv_enter=1&rsv_sug3=10&rsv_sug1=11&rsv_sug7=100', function (status) {\n        let obj = {\n            code: 1, //返回状态码，1为成功，0为失败\n            msg: '抓取成功', //返回的信息\n            word: '示例关键字', //抓取的关键字\n            time: 2000, //任务的时间\n            dataList: [   //抓取结果列表\n                {\n                    title: 'xx',  //结果条目的标题\n                    info: '', //摘要\n                    link: '', //链接\n                    pic: '' //缩略图地址\n                }\n            ]\n        };\n\n        if (status !== 'success') {\n            time = Date.now() - time;\n            obj = {\n                code: 0, //返回状态码，1为成功，0为失败\n                msg: '抓取失败', //返回的信息\n                word: key, //抓取的关键字\n                time: time, //任务的时间\n                dataList: []\n            };\n            console.log(JSON.stringify(obj));\n            phantom.exit();\n        } else {\n            time = Date.now() - time;\n            console.log('Loading ' + key);\n            console.log('Loading time ' + time + ' msec');\n\n            //加载外部脚步\n            page.includeJs(\"https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js\", function () {\n                //evaluate方法用于打开网页以后，在页面中执行JavaScript代码\n                page.evaluate(function () {\n                    \n                    Array.form($('.c-row.c-gap-top-small')).forEach((val,index) => {\n                        let item = {};\n                        item.title = val.previousElementSibling.innerText;\n                        item.info = val.lastElementChild.innerText;\n                        item.link = val.previousElementSibling.firstElementChild.href;\n                        item.pic =val.firstElementChild.firstElementChild.firstElementChild.src;\n                        obj.dataList.push(item);\n                    });\n\n                });\n                console.log(JSON.stringify(obj));\n                phantom.exit()\n            });\n        }\n\n    });\n\n}\n\n"]}