{"version":3,"sources":["../../../stickyRice/MusicPlayer/Random-music.js"],"names":["window","onload","init","audios","document","getElementById","app","Vue","el","data","loop","imgSrc","channelId","song","seen","picture","url","songName","artist","volume","paused","animationPlayState","isPlaying","created","getChannel","getMusic","volumeChange","setInterval","progress","methods","play","pause","nextSong","axios","get","then","response","console","log","channels","num","Math","floor","random","length","channel_id","bind","catch","error","channel","params","title","src","songLoop","currentTime","duration","plan","querySelector","btn","style","width","left","btnDown","event","clientX","barChange","clientWidth","targetWidth","offsetX","scale"],"mappings":"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","file":"Random-music.js","sourcesContent":["/**\n * Created by shi on 2017/5/3.\n */\n\n\nwindow.onload = function () {\n\n    function init() {\n\n        const audios = document.getElementById('audios');\n\n        let app = new Vue({\n            el: '#fm',\n            data: {\n                loop: {\n                    imgSrc: 'imgs/icon_order.png'\n                },\n                channelId: 0,\n                song: {\n                    seen: false,\n                    picture: '',\n                    url: '',\n                    songName: '',\n                    artist: '',\n                    volume: 0.5\n                },\n                paused: {\n                    animationPlayState: \"running\"\n                },\n                isPlaying: false\n            },\n            created: function () {\n                this.getChannel();\n                this.getMusic(this.channelId);\n                this.volumeChange(null,true);\n                setInterval(this.progress,500);\n\n            },\n            methods: {\n                //播放和暂停\n                play: function () {\n                    if(audios.paused){\n                        this.song.seen = false;\n                        this.paused = {\n                            animationPlayState: \"running\"\n                        };\n                        if(!this.isPlaying){\n                            audios.play();\n                            this.isPlaying = true;\n                        }\n                    }\n                    else {\n                        this.song.seen = true;\n                        this.paused = {\n                            animationPlayState: \"paused\"\n                        }\n                        if(this.isPlaying){\n                            audios.pause();\n                            this.isPlaying = false;\n                        }\n\n                    }\n                },\n                //随机下一首\n                nextSong: function () {\n\n                    if(this.song.seen){\n                        this.song.seen = false;\n                        this.getMusic(this.channelId);\n                    }\n                    else {\n                        this.getMusic(this.channelId);\n                    }\n                },\n                getChannel: function () {\n                    axios.get('http://api.jirengu.com/fm/getChannels.php')\n                        .then(function (response) {\n                            console.log(response.data);\n                            let channels = response.data.channels;\n                            let num = Math.floor(Math.random()*channels.length);\n\n                            this.channelId = channels[num].channel_id;\n                            console.log(this.channelId);\n\n                        }.bind(this))\n                        .catch(function (error) {\n                            console.log(error);\n                        });\n                },\n                getMusic: function (channel) {\n                    axios.get('http://api.jirengu.com/fm/getSong.php', {\n                        params: {\n                            \"channel\": channel\n                        }\n                    })\n                        .then(function (response) {\n                            console.log(response.data);\n                            let song = response.data.song[0];\n                            this.song = {\n                                seen: false,\n                                picture: song.picture,\n                                url: song.url,\n                                songName: song.title,\n                                artist: song.artist\n                            }\n                            audios.src = song.url;\n                            audios.play();\n                            this.isPlaying = true;\n                        }.bind(this))\n                        .catch(function (error) {\n                            console.log(error);\n                        })\n\n                },\n                //是否单曲循环\n                songLoop: function () {\n                    if(audios.loop){\n                        this.loop = {\n                            imgSrc: 'imgs/icon_order.png'\n                        }\n                        audios.loop = false;\n\n                    }\n                    else {\n                        this.loop = {\n                            imgSrc: 'imgs/icon_loop.png'\n                        }\n                        audios.loop = true;\n                    }\n                    console.log(audios.loop);\n                },\n                progress: function () {\n                    let length = audios.currentTime / audios.duration * 100,\n                        plan = document.querySelector('.fm-controls_plan'),\n                        btn = document.querySelector('.fm-controls_btn');\n\n                    plan.style.width = length + '%';\n                    btn.style.left = length + '%';\n\n                    //自动下一曲\n                    if(audios.currentTime === audios.duration){\n                        app.nextSong();\n                    }\n                },\n                //拖动快进\n                btnDown: function (event) {\n                    console.log(event.clientX);\n\n                },\n                //点击快进\n                barChange: function (event) {\n                    //总长度\n                    let length = document.querySelector('.fm-controls_center').clientWidth,\n                        //点击位置\n                        targetWidth = event.offsetX;\n                    //比例\n                    let scale = targetWidth / length;\n\n                    //设置音频位置\n                    audios.currentTime = audios.duration * scale;\n\n                    //暂停后重新快进播放\n                    if(audios.paused){\n                        this.song.seen = false;\n                        this.paused = {\n                            animationPlayState: \"running\"\n                        };\n                        if(!this.isPlaying){\n                            audios.play();\n                            this.isPlaying = true;\n                        }\n                    }\n\n                },\n                //调节音量\n                volumeChange: function (event,num) {\n                    let length = document.querySelector('.fm-volume').clientWidth - 35,\n                        targetWidth = null,\n                        scale = 0,\n                        plan = document.querySelector('.fm-volume_plan');\n\n\n\n                    if(num){\n                        audios.volume = this.song.volume;\n                        plan.style.width = length * 0.5 + 'px';\n\n                    }\n                    else {\n                        targetWidth = event.offsetX;\n                        scale = targetWidth / length;\n\n                        this.song.volume = scale;\n                        audios.volume = scale;\n                        console.log(scale);\n                        plan.style.width = targetWidth + 'px';\n                    }\n\n\n                }\n\n            }\n        });\n        \n    }\n    \n    init();\n\n    //vue v-bind 无法修改  audio  的属性\n\n\n}\n\n\n\n"]}